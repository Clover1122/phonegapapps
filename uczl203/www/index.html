
<!-- saved from url=(0064)https://developer.cege.ucl.ac.uk:31084/week2/leafletGeoJSON.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <!-- the following links add the CSS and Javascript required for the Leaflet Map -->
      <link rel="stylesheet" href="./index_files/leaflet.css" integrity="sha512-
wcw6ts8Anuw10Mzh9Ytw4pylW8+NAD4ch3lqm9lzAsTxg0GFeJgoAtxuCLREZSC5lUXdVyo/7yfsqFjQ4S+aKw==" crossorigin="">

      <script src="./index_files/leaflet.js.download" integrity="sha512-
mNqn2Wg7tSToJhvHcqfzLMU6J4mkOImSPTxVZAdo+lcPlk+GhZmYgACEe0x35K7YzW1zJ7XyJV/TT1MrdXvMcA==
" crossorigin=""></script>

      <!-- the following links incorporate the CSS required for custom icon creation -->
      <link rel="stylesheet" href="./index_files/ionicons.min.css">
      <link rel="stylesheet" href="./index_files/leaflet.awesome-markers.css">
      <script src="./index_files/leaflet.awesome-markers.js.download"></script>

      <script>
      // create a variable that will hold the XMLHttpRequest() 
      var client;
      // and a variable that will hold the layer itself
      var earthquakelayer;
      // create the code to get the Earthquakes data using an XMLHttpRequest
      function getEarthquakes() {
        client = new XMLHttpRequest();
      client.open('GET','https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson');
        client.onreadystatechange = earthquakeResponse; // don't use earthquakeResponse() with brackets 
        client.send();
      }

      // create the code to wait for the response from the data server, and process the response once it is received
      function earthquakeResponse() {
        if (client.readyState == 4) {
          var earthquakedata = client.responseText;
          loadEarthquakelayer(earthquakedata);
        }
      }

      // convert the received text data to JSON format and add it to the map
      function loadEarthquakelayer(earthquakedata) {
      var earthquakejson = JSON.parse(earthquakedata );// convert the text received from the server to JSON
      var earthquakelayer = L.geoJson(earthquakejson,// load the geoJSON layer
        {
          pointToLayer: function (feature, latlng) // use point to layer to create the points
          {
            if (feature.properties.mag > 1.75) {
              return L.marker(latlng, {icon:testMarkerRed}).bindPopup("<b>"+feature.properties.place+"</b>");
            }
            else {
              return L.marker(latlng, {icon:testMarkerPink}).bindPopup("<b>"+feature.properties.place+"</b>");;
            }
          },
        }).addTo(mymap);
      mymap.fitBounds(earthquakelayer.getBounds());
    }
      </script>
      <!-- the following CSS is used to set the size of the Map -->
      <style type="text/css">
               #mapid { height: 180px; }
      </style>
</head>
<body>
      <!-- the mapid div will hold the map -->
      <div id="mapid" style="width: 600px; height: 400px; position: relative; outline: none;" class="leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" tabindex="0"><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 0px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" role="presentation" src="./index_files/2.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(49px, -35px, 0px); opacity: 1;"><img alt="" role="presentation" src="./index_files/2(1).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(305px, -35px, 0px); opacity: 1;"><img alt="" role="presentation" src="./index_files/3.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(49px, 221px, 0px); opacity: 1;"><img alt="" role="presentation" src="./index_files/3(1).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(305px, 221px, 0px); opacity: 1;"><img alt="" role="presentation" src="./index_files/2(2).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-207px, -35px, 0px); opacity: 1;"><img alt="" role="presentation" src="./index_files/2(3).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(561px, -35px, 0px); opacity: 1;"><img alt="" role="presentation" src="./index_files/3(2).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-207px, 221px, 0px); opacity: 1;"><img alt="" role="presentation" src="./index_files/3(3).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(561px, 221px, 0px); opacity: 1;"></div></div></div><div class="leaflet-pane leaflet-shadow-pane"><div class="awesome-marker-shadow awesome-marker leaflet-zoom-animated" style="margin-left: -10px; margin-top: -12px; width: 36px; height: 16px; transform: translate3d(206px, 35px, 0px);"></div><div class="awesome-marker-shadow awesome-marker leaflet-zoom-animated" style="margin-left: -10px; margin-top: -12px; width: 36px; height: 16px; transform: translate3d(188px, 364px, 0px);"></div><div class="awesome-marker-shadow awesome-marker leaflet-zoom-animated" style="margin-left: -10px; margin-top: -12px; width: 36px; height: 16px; transform: translate3d(411px, 276px, 0px);"></div></div><div class="leaflet-pane leaflet-overlay-pane"></div><div class="leaflet-pane leaflet-marker-pane"><div class="awesome-marker-icon-pink awesome-marker leaflet-zoom-animated leaflet-interactive" tabindex="0" style="margin-left: -17px; margin-top: -42px; width: 35px; height: 45px; transform: translate3d(206px, 35px, 0px); z-index: 35;"><i class=" glyphicon glyphicon-play  icon-white"></i></div><div class="awesome-marker-icon-red awesome-marker leaflet-zoom-animated leaflet-interactive" tabindex="0" style="margin-left: -17px; margin-top: -42px; width: 35px; height: 45px; transform: translate3d(188px, 364px, 0px); z-index: 364;"><i class=" glyphicon glyphicon-play  icon-white"></i></div><div class="awesome-marker-icon-pink awesome-marker leaflet-zoom-animated leaflet-interactive" tabindex="0" style="margin-left: -17px; margin-top: -42px; width: 35px; height: 45px; transform: translate3d(411px, 276px, 0px); z-index: 276;"><i class=" glyphicon glyphicon-play  icon-white"></i></div></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(250.54px, 746.745px, 0px) scale(4);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="https://developer.cege.ucl.ac.uk:31084/week2/leafletGeoJSON.html#" title="Zoom in" role="button" aria-label="Zoom in">+</a><a class="leaflet-control-zoom-out" href="https://developer.cege.ucl.ac.uk:31084/week2/leafletGeoJSON.html#" title="Zoom out" role="button" aria-label="Zoom out">−</a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="http://leafletjs.com/" title="A JS library for interactive maps">Leaflet</a> | Map data © <a href="http://openstreetmap.org/">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com/">Mapbox</a></div></div></div></div>

      <!-- the following script will load the map and set the default view and zoom, as well as loading the basemap tiles -->
      <script>
      // load the map data after the page has loaded
      document.addEventListener('DOMContentLoaded', function() {
        getEarthquakes();
      }, false);
      // load the map
      var mymap = L.map('mapid').setView([51.505, -0.09], 13);

      // load the tiles
      L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
                          maxZoom: 18,
                          attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                                       '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                                       'Imagery © <a href="http://mapbox.com">Mapbox</a>',
                          id: 'mapbox.streets'
              }).addTo(mymap);
      // creat the customer Maker icon
      var testMarkerRed = L.AwesomeMarkers.icon({
        icon: 'play',
        markerColor: 'red'
      });
      var testMarkerPink = L.AwesomeMarkers.icon({
        icon: 'play',
        markerColor: 'pink'
      });
      </script>

</body></html>